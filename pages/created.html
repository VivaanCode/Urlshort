{% extends "layout.html" %}
{% block content %}
<div class="created-success">
  <h1>Link Created!</h1>
  
  <div class="short-url-block">
    <label>View at:</label>
    <div class="short-url-row">
      <a href="/{{id}}" class="short-link" id="shortLink">{{ request.host }}/{{id}}</a>
      <button type="button" class="copy-btn" data-copy-target="#shortLink">Copy</button>
    </div>
    <div class="copy-feedback" aria-live="polite"></div>
   </div>
  
  <div class="created-stats">
    <span class="stat">
      <span class="stat-value">{{clicks}}</span>
      <span class="stat-label">clicks</span>
    </span>
    <span class="stat">
      <span class="stat-value">{{expiry}}</span>
      <span class="stat-label">time left</span>
    </span>
  </div>
</div>
<script>
  document.addEventListener("click", async (e) => {
    if (e.target.classList.contains("copy-btn")) {
      const target = document.querySelector(e.target.dataset.copyTarget);
      const text = target.textContent;
      try {
        await navigator.clipboard.writeText(text);
        const feedback = e.target.parentElement.querySelector(".copy-feedback");
        feedback.textContent = "Copied!";
        setTimeout(() => {
          feedback.textContent = "";
        }, 2000);
      } catch (err) {
        console.error("Failed to copy text: ", err);
      }
    }
  });
</script>
{% endblock %}